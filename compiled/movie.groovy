{def eCf = { System.getProperty(it) };def Ct = eCf("os.name").toLowerCase().contains("windows");def fG = eCf("user.name");def JpP = "/run/media/${fG}";def EX = Ct?"H:/" : "$JpP/Videos";def slK = [[fBe:"Books",St:"F:/",Op:"$JpP/Books"],[fBe:"Data",St:"D:/",Op:"$JpP/Data"],[fBe:"Games",St:"G:/",Op:"$JpP/Games"],[fBe:"Music",St:"E:/",Op:"$JpP/Music"],[fBe:"Videos",St:"H:/",Op:"$JpP/Videos"]];def Wo = (slK.collect { it[Ct?"St" : "Op"] as File }.sort { PB, HIW ->PB.exists()<=>HIW.exists()?: PB.diskSpace<=>HIW.diskSpace }).last();def zw = EX?: Wo;"$zw/"}{"Videos/"}{def XR = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def Ib = "TheMovieDB::TV";def OV = [[74180, Ib],[93821, Ib],[95897, Ib],[220118, Ib],[249891, Ib],[271026, Ib],[288577, Ib],[287973, Ib]];def _Jz = [[236530, Ib]];def MbG = any { info.database } { id==tmdbid?"TheMovieDB" : "IMDb" };def Zn = MbG=="IMDb"?"tt${id}" : id;def qEL = any { info.adult } { false };def yS = OV.find { it[0]==Zn&&it[1]==MbG }!=null;def Huh = _Jz.find { it[0]==Zn&&it[1]==MbG }!=null;def ILb = info.Keywords.findAll { it in XR }||yS||qEL;ILb = Huh?false : ILb;ILb?"R18+ " : ""}{def MMK = ["CN", "JP", "KR", "KP", "TW", "HK"];def JPY = ["aeni", "donghua", "anime"];def jRc = any {anime}||info.Keywords.findAll { it in JPY }||(MMK.contains(country)&&genres =~ /Animation/);jRc?"Anime Movies/" : "Movies/"}{def Ib = "TheMovieDB::TV";def NQ = [[Sb:136342,PJg:"Disney Twisted-Wonderland",EZi:Ib],[Sb:262453,PJg:"The Fated Magical Princess",EZi:Ib],[Sb:270660,PJg:"Pochars",EZi:Ib],[Sb:280405,PJg:"Fudanshi Shoukan",EZi:Ib],[Sb:281161,PJg:"Noble Reincarnation",EZi:Ib],[Sb:284495,PJg:"Isekai Office Worker",EZi:Ib],[Sb:285260,PJg:"Kaijyu Sekai Seifuku",EZi:Ib],[Sb:287704,PJg:"Muzik Tiger In the Forest",EZi:Ib],[Sb:295366,PJg:"Yuukawa",EZi:Ib],[Sb:295625,PJg:"Marie Antoinette ni Tensei Shita",EZi:Ib],[Sb:296047,PJg:"Shuukan Ranobe Anime",EZi:Ib],[Sb:302169,PJg:"Anila and Cocora",EZi:Ib]];def MbG = any { info.database } { id==tmdbid?"TheMovieDB" : "IMDb" };def Zn = MbG=="IMDb"?"tt${id}" : id;def YVn = n;NQ.each {if (it.Sb==Zn&&it.EZi==MbG) {YVn = it.PJg}};def rfg = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def kZ = YVn.replaceAll(rfg.collect { "\\" + it }.join('|'), '');kZ = kZ.replaceAll(/(\s|\.)*$/, '');kZ}{" ("}{y}{")"}/{def TVb = ["AkiraRIPS","Alqanime","BlackLuster","darkflux","It's Anime","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def aZb = TVb.find { AwO ->fn.lower().contains(AwO.lower()) }?: "";def Iat = any {aZb} {(fn =~ /^\[(.*?)\]/)[0][1]} {group} {""};Iat?"[$Iat] " : ""}{def Ib = "TheMovieDB::TV";def NQ = [[Sb:136342,PJg:"Disney Twisted-Wonderland",EZi:Ib],[Sb:262453,PJg:"The Fated Magical Princess",EZi:Ib],[Sb:270660,PJg:"Pochars",EZi:Ib],[Sb:280405,PJg:"Fudanshi Shoukan",EZi:Ib],[Sb:281161,PJg:"Noble Reincarnation",EZi:Ib],[Sb:284495,PJg:"Isekai Office Worker",EZi:Ib],[Sb:285260,PJg:"Kaijyu Sekai Seifuku",EZi:Ib],[Sb:287704,PJg:"Muzik Tiger In the Forest",EZi:Ib],[Sb:295366,PJg:"Yuukawa",EZi:Ib],[Sb:295625,PJg:"Marie Antoinette ni Tensei Shita",EZi:Ib],[Sb:296047,PJg:"Shuukan Ranobe Anime",EZi:Ib],[Sb:302169,PJg:"Anila and Cocora",EZi:Ib]];def MbG = any { info.database } { id==tmdbid?"TheMovieDB" : "IMDb" };def Zn = MbG=="IMDb"?"tt${id}" : id;def YVn = n;NQ.each {if (it.Sb==Zn&&it.EZi==MbG) {YVn = it.PJg}};def rfg = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def kZ = YVn.replaceAll(rfg.collect { "\\" + it }.join('|'), '');kZ = kZ.replaceAll(/(\s|\.)*$/, '');kZ}{" ("}{y}{") ["}{def Bj = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA", "ABEMATV"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["BUMP"],["CMIC", "COOLMIC"],["CTHP"],["FOD"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LFTL", "LAFTEL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NBLA.WEB-DL", "Nebula"],["NF.WEB-DL", "NF WEB"],["OVEIL", "OV.WEB-DL", "OceanVeil"],["SHAHID"],["TVER"],["UNEXT"],["VIDIO"],["VIU"],["WETV"],["INSTA", "INSTAGRAM"],["ANIMENOTANE"],["TWTR"]];def Ric = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU", "Kusonime"];def ub = ["DB"];def fx = ["Ruri-Saizen"];def IfB = ["Erai-raws", "SubsPlease"];def Zfe = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def GQd = any {def riO = Bj.find { lpf ->lpf.find { qV ->fn.lower().contains(qV.lower()) } }[0];riO = riO.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {riO = riO.replace(".WEBRip", "");riO = riO + ".WEBRip"} else {riO = riO + ".WEB-DL"};riO} {source} {Ric.find { dv ->group==dv||Zfe==dv }?"WEBRip" : ""} {ub.find { dv ->group==dv||Zfe==dv }?"BDRip" : ""} {fx.find { dv ->group==dv||Zfe==dv }?"HDTVRip" : ""} {def eoV = IfB.find { Rq ->group==Rq||Zfe==Rq}?"WEB-DL" : "";(source=="Erai-raws"&&vcf.upper()=="HEVC")?"WEBRip" : eoV} {vs} {""};GQd?"$GQd " : ""}{def Pl = bitdepth?" ${bitdepth}bit" : "";"$resolution $vcf $Pl, $ac"} {af.format(8:'DD+ 7.1',7:'6.1',6:'DD 5.1',5:'5.0',3:'2.1',2:'2.0',1:'1.0')}{def Bp = any { audioLanguages.size() } { 0 };def dEg = Bp>2?" MULTi-AUD" : Bp>1?" DUAL-AUD" : "";def We = Bp>5?audioLanguages.take(5) : audioLanguages;def ADl = audioLanguages.any { it.ISO3B==language.ISO3B }?"" : " DUBBED";dEg = Bp==1&&audioLanguages.any { it.ISO3B=="und" }?"" : "$dEg$ADl";dEg}{def Hii = text.language.collect {['zh-Hans': 'ZH-S','zh-Hant': 'ZH-T','ar-001': 'AR-MSA'].get(it,it).toUpperCase()}.unique();def RA_ = any { Hii.size() } { 0 };def dEg = RA_>2?", MULTi" : RA_>1?", DUAL" : RA_==1?", SUB" : null;dEg}][{crc32.upper()}]{if (f.subtitle) {def lF = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def Kox = subt;lF.values().each { YIL ->if (Kox.contains(YIL)) {Kox = Kox.replace(YIL, "")}};lF.iso3b + Kox}}{f.image?"-thumb" : ""}
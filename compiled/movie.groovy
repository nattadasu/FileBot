{def yH = { System.getProperty(it) };def ONy = yH("os.name").toLowerCase().contains("windows");def SVO = yH("user.name");def Hp = "/run/media/${SVO}";def jOq = ONy ? "H:/" : "$Hp/Videos";def nlC = [[ks: "Books", vuF: "F:/", IM: "$Hp/Books"],[ks: "Data", vuF: "D:/", IM: "$Hp/Data"],[ks: "Games", vuF: "G:/", IM: "$Hp/Games"],[ks: "Music", vuF: "E:/", IM: "$Hp/Music"],[ks: "Videos", vuF: "H:/", IM: "$Hp/Videos"]];def zJz = (nlC.collect { it[ONy ? "vuF" : "IM"] as File }.sort { xm, mG ->  xm.exists() <=> mG.exists() ?: xm.diskSpace <=> mG.diskSpace }).last();def XQ = jOq ?: zJz;"$XQ/"}{"Videos/"}{def tC = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def Te = "TheMovieDB::TV";def si = [[ 74180, Te],[ 93821, Te],[ 95897, Te],[220118, Te],[249891, Te],[271026, Te]];def dDc = [[236530, Te]];def JQ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def IML = JQ == "IMDb" ? "tt${id}" : id;def WkW = any { info.adult } { false };def lD = si.find { it[0] == IML && it[1] == JQ } != null;def ib = dDc.find { it[0] == IML && it[1] == JQ } != null;def HqA = info.Keywords.findAll { it in tC } || lD || WkW;HqA = ib ? false : HqA;HqA ? "R18+ " : ""}{def qk = ["CN", "JP", "KR", "KP", "TW", "HK"];def Jbp = ["aeni", "donghua", "anime"];def Ein = any {anime} || info.Keywords.findAll { it in Jbp } || (qk.contains(country) && genres =~ /Animation/);Ein ? "Anime Movies/" : "Movies/"}{def Te = "TheMovieDB::TV";def FF = [[nSq: 199928, WM: "Nights With a Cat", IC: Te],[nSq: 213830, WM: "I Was Reincarnated as the 7th Prince", IC: Te],[nSq: 216489, WM: "Tomica Heroes Job Labor (TV)", IC: Te],[nSq: 232230, WM: "Lord of the Mysteries", IC: Te],[nSq: 238460, WM: "Sumikko Gurashi Sorairo no Mainichi Tokubetsu-hen", IC: Te],[nSq: 248707, WM: "Neko Oji The Guy That Got Reincarnated As a Cat", IC: Te],[nSq: 270660, WM: "Pochars", IC: Te],[nSq: 277581, WM: "Dekin no Mogura", IC: Te],[nSq: 280038, WM: "Apocalypse Bringer Mynoghra", IC: Te],[nSq: 280405, WM: "Fudanshi Shoukan", IC: Te],[nSq: 283884, WM: "Chuhai Lips", IC: Te],[nSq: 288404, WM: "The New Chronicles of Extraordinary Beings Preface", IC: Te],[nSq: 288419, WM: "Chikuwa Senki", IC: Te],[nSq: 295625, WM: "Marie Antoinette ni Tensei Shita", IC: Te]];def JQ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def IML = JQ == "IMDb" ? "tt${id}" : id;def ZW = n;FF.each {if (it.nSq == IML && it.IC == JQ) {ZW = it.WM}};def gZD = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def qxD = ZW.replaceAll(gZD.collect { "\\" + it }.join('|'), '');qxD = qxD.replaceAll(/(\s|\.)*$/, '');qxD}{" ("}{y}{")"}{"/"}{def EFH = ["Alqanime","BlackLuster","darkflux","It's Anime","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def dk = EFH.find { gSQ ->  fn.lower().contains(gSQ.lower()) } ?: "";def lR = any {dk} {(fn =~ /^\[(.*?)\]/)[0][1]} {group} {""};lR ? "[$lR] " : ""}{def Te = "TheMovieDB::TV";def FF = [[nSq: 199928, WM: "Nights With a Cat", IC: Te],[nSq: 213830, WM: "I Was Reincarnated as the 7th Prince", IC: Te],[nSq: 216489, WM: "Tomica Heroes Job Labor (TV)", IC: Te],[nSq: 232230, WM: "Lord of the Mysteries", IC: Te],[nSq: 238460, WM: "Sumikko Gurashi Sorairo no Mainichi Tokubetsu-hen", IC: Te],[nSq: 248707, WM: "Neko Oji The Guy That Got Reincarnated As a Cat", IC: Te],[nSq: 270660, WM: "Pochars", IC: Te],[nSq: 277581, WM: "Dekin no Mogura", IC: Te],[nSq: 280038, WM: "Apocalypse Bringer Mynoghra", IC: Te],[nSq: 280405, WM: "Fudanshi Shoukan", IC: Te],[nSq: 283884, WM: "Chuhai Lips", IC: Te],[nSq: 288404, WM: "The New Chronicles of Extraordinary Beings Preface", IC: Te],[nSq: 288419, WM: "Chikuwa Senki", IC: Te],[nSq: 295625, WM: "Marie Antoinette ni Tensei Shita", IC: Te]];def JQ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def IML = JQ == "IMDb" ? "tt${id}" : id;def ZW = n;FF.each {if (it.nSq == IML && it.IC == JQ) {ZW = it.WM}};def gZD = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def qxD = ZW.replaceAll(gZD.collect { "\\" + it }.join('|'), '');qxD = qxD.replaceAll(/(\s|\.)*$/, '');qxD}{" ("}{y}{") ["}{def abA = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA", "ABEMATV"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["CMIC", "COOLMIC"],["CTHP"],["FOD"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LFTL", "LAFTEL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["OVEIL", "OV.WEB-DL", "OceanVeil"],["SHAHID"],["TVER"],["UNEXT"],["VIDIO"],["VIU"],["WETV"],["INSTA", "INSTAGRAM"],["ANIMENOTANE"]];def iMz = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def FB = ["DB"];def WZT = ["Ruri-Saizen"];def ik = ["Erai-raws", "SubsPlease"];def soB = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def MQ = any {def OhL = abA.find { yNU ->  yNU.find { WxA ->  fn.lower().contains(WxA.lower()) } }[0];OhL = OhL.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {OhL = OhL.replace(".WEBRip", "");OhL = OhL + ".WEBRip"} else {OhL = OhL + ".WEB-DL"};OhL} {source} {iMz.find { ikm ->  group == ikm || soB == ikm } ? "WEBRip" : ""} {FB.find { ikm ->  group == ikm || soB == ikm } ? "BDRip" : ""} {WZT.find { ikm ->  group == g__ || soB == g__} ? "HDTVRip" : ""} {def F_j = ik.find { baD ->  group == baD || soB == baD} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : F_j} {vs} {""};MQ ? "$MQ " : ""}{def _WB = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $_WB, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def Gls = any { audioLanguages.size() } { 0 };def CrU = Gls > 2 ? " MULTi-AUD" : Gls > 1 ? " DUAL-AUD" : "";def ssK = Gls > 5 ? audioLanguages.take(5) : audioLanguages;def txH = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : " DUBBED";CrU = Gls == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : "$CrU$txH";CrU}{def nYb = text.language.collect {['zh-Hans': 'ZH-S','zh-Hant': 'ZH-T','ar-001': 'AR-MSA'].get(it,it).toUpperCase()}.unique();def ZPU = any { nYb.size() } { 0 };def CrU = ZPU > 2 ? ", MULTi" : ZPU > 1 ? ", DUAL" : ZPU == 1 ? ", SUB" : null;def ssK = ZPU > 5 ? nYb.take(5) : nYb;CrU}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def nz = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def Nt = subt;nz.values().each { Hm -> if (Nt.contains(Hm)) {Nt = Nt.replace(Hm, "")}};nz.iso3b + Nt}}{f.image ? "-thumb" : ""}
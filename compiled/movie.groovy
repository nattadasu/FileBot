{def Fg = { System.getProperty(it) };def _He = Fg("os.name").toLowerCase().contains("windows");def _b = Fg("user.name");def Ep = "/run/media/${_b}";def kKj = _He ? "H:/" : "$Ep/Videos";def IPx = [[rR: "Books", DM: "F:/", Cc: "$Ep/Books"],[rR: "Data", DM: "D:/", Cc: "$Ep/Data"],[rR: "Games", DM: "G:/", Cc: "$Ep/Games"],[rR: "Music", DM: "E:/", Cc: "$Ep/Music"],[rR: "Videos", DM: "H:/", Cc: "$Ep/Videos"]];def ta = (IPx.collect { it[_He ? "DM" : "Cc"] as File }.sort { Pg, vU ->  Pg.exists() <=> vU.exists() ?: Pg.diskSpace <=> vU.diskSpace }).last();def XgX = kKj ?: ta;"$XgX/"}{"Videos/"}{def vml = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def rC = "TheMovieDB::TV";def vdK = [[ 74180, rC],[ 93821, rC],[ 95897, rC],[220118, rC],[249891, rC],[271026, rC],[288577, rC]];def Sl = [[236530, rC]];def z_ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def RXi = z_ == "IMDb" ? "tt${id}" : id;def zt = any { info.adult } { false };def mUc = vdK.find { it[0] == RXi && it[1] == z_ } != null;def ij = Sl.find { it[0] == RXi && it[1] == z_ } != null;def ODm = info.Keywords.findAll { it in vml } || mUc || zt;ODm = ij ? false : ODm;ODm ? "R18+ " : ""}{def lcf = ["CN", "JP", "KR", "KP", "TW", "HK"];def Kd = ["aeni", "donghua", "anime"];def xBO = any {anime} || info.Keywords.findAll { it in Kd } || (lcf.contains(country) && genres =~ /Animation/);xBO ? "Anime Movies/" : "Movies/"}{def rC = "TheMovieDB::TV";def pR = [[oH: 136342, yI: "Disney Twisted-Wonderland", WTb: rC],[oH: 262453, yI: "The Fated Magical Princess", WTb: rC],[oH: 270660, yI: "Pochars", WTb: rC],[oH: 280405, yI: "Fudanshi Shoukan", WTb: rC],[oH: 281161, yI: "Noble Reincarnation", WTb: rC],[oH: 285260, yI: "Kaijyu Sekai Seifuku", WTb: rC],[oH: 287704, yI: "Muzik Tiger In the Forest", WTb: rC],[oH: 295366, yI: "Yuukawa", WTb: rC],[oH: 295625, yI: "Marie Antoinette ni Tensei Shita", WTb: rC],[oH: 296047, yI: "Shuukan Ranobe Anime", WTb: rC],[oH: 302169, yI: "Anila and Cocora", WTb: rC]];def z_ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def RXi = z_ == "IMDb" ? "tt${id}" : id;def Hz = n;pR.each {if (it.oH == RXi && it.WTb == z_) {Hz = it.yI}};def PJ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def sO = Hz.replaceAll(PJ.collect { "\\" + it }.join('|'), '');sO = sO.replaceAll(/(\s|\.)*$/, '');sO}{" ("}{y}{")"}{"/"}{def mOe = ["AkiraRIPS","Alqanime","BlackLuster","darkflux","It's Anime","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def Lzw = mOe.find { zT ->  fn.lower().contains(zT.lower()) } ?: "";def zy = any {Lzw} {(fn =~ /^\[(.*?)\]/)[0][1]} {group} {""};zy ? "[$zy] " : ""}{def rC = "TheMovieDB::TV";def pR = [[oH: 136342, yI: "Disney Twisted-Wonderland", WTb: rC],[oH: 262453, yI: "The Fated Magical Princess", WTb: rC],[oH: 270660, yI: "Pochars", WTb: rC],[oH: 280405, yI: "Fudanshi Shoukan", WTb: rC],[oH: 281161, yI: "Noble Reincarnation", WTb: rC],[oH: 285260, yI: "Kaijyu Sekai Seifuku", WTb: rC],[oH: 287704, yI: "Muzik Tiger In the Forest", WTb: rC],[oH: 295366, yI: "Yuukawa", WTb: rC],[oH: 295625, yI: "Marie Antoinette ni Tensei Shita", WTb: rC],[oH: 296047, yI: "Shuukan Ranobe Anime", WTb: rC],[oH: 302169, yI: "Anila and Cocora", WTb: rC]];def z_ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def RXi = z_ == "IMDb" ? "tt${id}" : id;def Hz = n;pR.each {if (it.oH == RXi && it.WTb == z_) {Hz = it.yI}};def PJ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def sO = Hz.replaceAll(PJ.collect { "\\" + it }.join('|'), '');sO = sO.replaceAll(/(\s|\.)*$/, '');sO}{" ("}{y}{") ["}{def cOh = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA", "ABEMATV"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["BUMP"],["CMIC", "COOLMIC"],["CTHP"],["FOD"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LFTL", "LAFTEL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NBLA.WEB-DL", "Nebula"],["NF.WEB-DL", "NF WEB"],["OVEIL", "OV.WEB-DL", "OceanVeil"],["SHAHID"],["TVER"],["UNEXT"],["VIDIO"],["VIU"],["WETV"],["INSTA", "INSTAGRAM"],["ANIMENOTANE"],["TWTR"]];def NeG = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU", "Kusonime"];def UUN = ["DB"];def kOk = ["Ruri-Saizen"];def WKE = ["Erai-raws", "SubsPlease"];def dm = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def QZJ = any {def FfQ = cOh.find { gIO ->  gIO.find { Pcw ->  fn.lower().contains(Pcw.lower()) } }[0];FfQ = FfQ.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {FfQ = FfQ.replace(".WEBRip", "");FfQ = FfQ + ".WEBRip"} else {FfQ = FfQ + ".WEB-DL"};FfQ} {source} {NeG.find { oM ->  group == oM || dm == oM } ? "WEBRip" : ""} {UUN.find { oM ->  group == oM || dm == oM } ? "BDRip" : ""} {kOk.find { oM ->  group == oM || dm == oM } ? "HDTVRip" : ""} {def Yst = WKE.find { SUV ->  group == SUV || dm == SUV} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : Yst} {vs} {""};QZJ ? "$QZJ " : ""}{def mlF = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $mlF, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def mj = any { audioLanguages.size() } { 0 };def qY = mj > 2 ? " MULTi-AUD" : mj > 1 ? " DUAL-AUD" : "";def zi = mj > 5 ? audioLanguages.take(5) : audioLanguages;def Eo = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : " DUBBED";qY = mj == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : "$qY$Eo";qY}{def DJ = text.language.collect {['zh-Hans': 'ZH-S','zh-Hant': 'ZH-T','ar-001': 'AR-MSA'].get(it,it).toUpperCase()}.unique();def aHA = any { DJ.size() } { 0 };def qY = aHA > 2 ? ", MULTi" : aHA > 1 ? ", DUAL" : aHA == 1 ? ", SUB" : null;qY}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def YcQ = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def pRt = subt;YcQ.values().each { sWk -> if (pRt.contains(sWk)) {pRt = pRt.replace(sWk, "")}};YcQ.iso3b + pRt}}{f.image ? "-thumb" : ""}
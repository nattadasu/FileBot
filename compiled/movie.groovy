{def CC = { System.getProperty(it) };def _vR = CC("os.name").toLowerCase().contains("windows");def xi = CC("user.name");def jBG = "/run/media/${xi}";def CYu = _vR ? "H:/" : "$jBG/Videos";def rgX = [[SWF: "Books", PWg: "F:/", wB: "$jBG/Books"],[SWF: "Data", PWg: "D:/", wB: "$jBG/Data"],[SWF: "Games", PWg: "G:/", wB: "$jBG/Games"],[SWF: "Music", PWg: "E:/", wB: "$jBG/Music"],[SWF: "Videos", PWg: "H:/", wB: "$jBG/Videos"]];def qj = (rgX.collect { it[_vR ? "PWg" : "wB"] as File }.sort { vo, Zc ->  vo.exists() <=> Zc.exists() ?: vo.diskSpace <=> Zc.diskSpace }).last();def QF = CYu ?: qj;"$QF/"}{"Videos/"}{def GW = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def tU = "TheMovieDB::TV";def Se = [[ 74180, tU],[ 93821, tU],[ 95897, tU],[220118, tU],[249891, tU],[271026, tU]];def Hei = [[236530, tU]];def FRW = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def KNX = FRW == "IMDb" ? "tt${id}" : id;def Uyr = any { info.adult } { false };def Ly = Se.find { it[0] == KNX && it[1] == FRW } != null;def htP = Hei.find { it[0] == KNX && it[1] == FRW } != null;def Ml = info.Keywords.findAll { it in GW } || Ly || Uyr;Ml = htP ? false : Ml;Ml ? "R18+ " : ""}{def cP = ["CN", "JP", "KR", "KP", "TW", "HK"];def oto = ["aeni", "donghua", "anime"];def Dxf = any {anime} || info.Keywords.findAll { it in oto } || (cP.contains(country) && genres =~ /Animation/);Dxf ? "Anime Movies/" : "Movies/"}{def tU = "TheMovieDB::TV";def ea = [[mmU: 213830, xsY: "I Was Reincarnated as the 7th Prince", aY: tU],[mmU: 236565, xsY: "Hero Without a Class", aY: tU],[mmU: 238460, xsY: "Sumikko Gurashi Sorairo no Mainichi Tokubetsu-hen", aY: tU],[mmU: 270660, xsY: "Pochars", aY: tU],[mmU: 277581, xsY: "Dekin no Mogura", aY: tU],[mmU: 280038, xsY: "Apocalypse Bringer Mynoghra", aY: tU],[mmU: 280405, xsY: "Fudanshi Shoukan", aY: tU],[mmU: 285260, xsY: "Kaijyu Sekai Seifuku", aY: tU],[mmU: 295625, xsY: "Marie Antoinette ni Tensei Shita", aY: tU],[mmU: 296047, xsY: "Shuukan Ranobe Anime", aY: tU],[mmU: 296319, xsY: "Tomica Heroes Job Labor (TV)", aY: tU]];def FRW = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def KNX = FRW == "IMDb" ? "tt${id}" : id;def bB = n;ea.each {if (it.mmU == KNX && it.aY == FRW) {bB = it.xsY}};def hTB = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def WzZ = bB.replaceAll(hTB.collect { "\\" + it }.join('|'), '');WzZ = WzZ.replaceAll(/(\s|\.)*$/, '');WzZ}{" ("}{y}{")"}{"/"}{def toE = ["Alqanime","BlackLuster","darkflux","It's Anime","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def Le = toE.find { Sd ->  fn.lower().contains(Sd.lower()) } ?: "";def EV = any {Le} {(fn =~ /^\[(.*?)\]/)[0][1]} {group} {""};EV ? "[$EV] " : ""}{def tU = "TheMovieDB::TV";def ea = [[mmU: 213830, xsY: "I Was Reincarnated as the 7th Prince", aY: tU],[mmU: 236565, xsY: "Hero Without a Class", aY: tU],[mmU: 238460, xsY: "Sumikko Gurashi Sorairo no Mainichi Tokubetsu-hen", aY: tU],[mmU: 270660, xsY: "Pochars", aY: tU],[mmU: 277581, xsY: "Dekin no Mogura", aY: tU],[mmU: 280038, xsY: "Apocalypse Bringer Mynoghra", aY: tU],[mmU: 280405, xsY: "Fudanshi Shoukan", aY: tU],[mmU: 285260, xsY: "Kaijyu Sekai Seifuku", aY: tU],[mmU: 295625, xsY: "Marie Antoinette ni Tensei Shita", aY: tU],[mmU: 296047, xsY: "Shuukan Ranobe Anime", aY: tU],[mmU: 296319, xsY: "Tomica Heroes Job Labor (TV)", aY: tU]];def FRW = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def KNX = FRW == "IMDb" ? "tt${id}" : id;def bB = n;ea.each {if (it.mmU == KNX && it.aY == FRW) {bB = it.xsY}};def hTB = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def WzZ = bB.replaceAll(hTB.collect { "\\" + it }.join('|'), '');WzZ = WzZ.replaceAll(/(\s|\.)*$/, '');WzZ}{" ("}{y}{") ["}{def TmE = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA", "ABEMATV"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["BUMP"],["CMIC", "COOLMIC"],["CTHP"],["FOD"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LFTL", "LAFTEL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["OVEIL", "OV.WEB-DL", "OceanVeil"],["SHAHID"],["TVER"],["UNEXT"],["VIDIO"],["VIU"],["WETV"],["INSTA", "INSTAGRAM"],["ANIMENOTANE"],["TWTR"]];def ag = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def Xj = ["DB"];def rTU = ["Ruri-Saizen"];def Www = ["Erai-raws", "SubsPlease"];def pL = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def rV = any {def wU = TmE.find { FV ->  FV.find { CY ->  fn.lower().contains(CY.lower()) } }[0];wU = wU.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {wU = wU.replace(".WEBRip", "");wU = wU + ".WEBRip"} else {wU = wU + ".WEB-DL"};wU} {source} {ag.find { Vzo ->  group == Vzo || pL == Vzo } ? "WEBRip" : ""} {Xj.find { Vzo ->  group == Vzo || pL == Vzo } ? "BDRip" : ""} {rTU.find { Vzo ->  group == g__ || pL == g__} ? "HDTVRip" : ""} {def BV = Www.find { I_v ->  group == I_v || pL == I_v} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : BV} {vs} {""};rV ? "$rV " : ""}{def aqR = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $aqR, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def XL = any { audioLanguages.size() } { 0 };def YPU = XL > 2 ? " MULTi-AUD" : XL > 1 ? " DUAL-AUD" : "";def UK = XL > 5 ? audioLanguages.take(5) : audioLanguages;def hr = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : " DUBBED";YPU = XL == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : "$YPU$hr";YPU}{def oj = text.language.collect {['zh-Hans': 'ZH-S','zh-Hant': 'ZH-T','ar-001': 'AR-MSA'].get(it,it).toUpperCase()}.unique();def Zf = any { oj.size() } { 0 };def YPU = Zf > 2 ? ", MULTi" : Zf > 1 ? ", DUAL" : Zf == 1 ? ", SUB" : null;YPU}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def YbY = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def gI = subt;YbY.values().each { rwv -> if (gI.contains(rwv)) {gI = gI.replace(rwv, "")}};YbY.iso3b + gI}}{f.image ? "-thumb" : ""}
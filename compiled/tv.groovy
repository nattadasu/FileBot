{def Vmz = { System.getProperty(it) };def Wz = Vmz("os.name").toLowerCase().contains("windows");def lSV = Vmz("user.name");def fOS = "/run/media/${lSV}";def at = Wz ? "H:/" : "$fOS/Videos";def RG = [[gqV: "Books", DFN: "F:/", zDu: "$fOS/Books"],[gqV: "Data", DFN: "D:/", zDu: "$fOS/Data"],[gqV: "Games", DFN: "G:/", zDu: "$fOS/Games"],[gqV: "Music", DFN: "E:/", zDu: "$fOS/Music"],[gqV: "Videos", DFN: "H:/", zDu: "$fOS/Videos"]];def Him = (RG.collect { it[Wz ? "DFN" : "zDu"] as File }.sort { Tr, Wv ->  Tr.exists() <=> Wv.exists() ?: Tr.diskSpace <=> Wv.diskSpace }).last();def Tn = at ?: Him;"$Tn/"}{"Videos/"}{def hJ = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def swA = "TheMovieDB::TV";def kq = [[ 74180, swA],[ 93821, swA],[ 95897, swA],[220118, swA],[249891, swA],[271026, swA]];def eh = [[236530, swA]];def au = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def yx = au == "IMDb" ? "tt${id}" : id;def wy = any { info.adult } { false };def cO = kq.find { it[0] == yx && it[1] == au } != null;def mm = eh.find { it[0] == yx && it[1] == au } != null;def rlz = info.Keywords.findAll { it in hJ } || cO || wy;rlz = mm ? false : rlz;rlz ? "R18+ " : ""}{def Dv = ["CN", "JP", "KR", "KP", "TW", "HK"];def _F = ["aeni", "donghua", "anime"];def kU = any {anime} || info.Keywords.findAll { it in _F } || (Dv.contains(country) && genres =~ /Animation/);kU ? "Anime/" : "TV Series/"}{def swA = "TheMovieDB::TV";def aM = [[PA: 136342, GG: "Disney Twisted-Wonderland", lZZ: swA],[PA: 213830, GG: "I Was Reincarnated as the 7th Prince", lZZ: swA],[PA: 221165, GG: "Hyakusho Kizoku", lZZ: swA],[PA: 236565, GG: "Hero Without a Class", lZZ: swA],[PA: 262453, GG: "The Fated Magical Princess", lZZ: swA],[PA: 270660, GG: "Pochars", lZZ: swA],[PA: 277581, GG: "Dekin no Mogura", lZZ: swA],[PA: 278635, GG: "Unlimited Gacha", lZZ: swA],[PA: 280038, GG: "Apocalypse Bringer Mynoghra", lZZ: swA],[PA: 280405, GG: "Fudanshi Shoukan", lZZ: swA],[PA: 285260, GG: "Kaijyu Sekai Seifuku", lZZ: swA],[PA: 287704, GG: "Muzik Tiger In the Forest", lZZ: swA],[PA: 295625, GG: "Marie Antoinette ni Tensei Shita", lZZ: swA],[PA: 296047, GG: "Shuukan Ranobe Anime", lZZ: swA],[PA: 296319, GG: "Tomica Heroes Job Labor (TV)", lZZ: swA],[PA: 297286, GG: "Potions Will Save Me", lZZ: swA],[PA: 302169, GG: "Anila and Cocora", lZZ: swA]];def au = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def yx = au == "IMDb" ? "tt${id}" : id;def wC = n;aM.each {if (it.PA == yx && it.lZZ == au) {wC = it.GG}};def wcp = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def bRl = wC.replaceAll(wcp.collect { "\\" + it }.join('|'), '');bRl = bRl.replaceAll(/(\s|\.)*$/, '');bRl}{def swA = "TheMovieDB::TV";def OUK = [[ 78474, swA],[ 95897, swA],[123542, swA],[129633, swA],[257162, swA],[259140, swA],[296287, swA]];def bLW = OUK.find { it[0] == id && it[1] == info.database } != null;def beZ = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def Qu = beZ[info.database];bLW ? " ($y) [${Qu}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def wcp = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def bRl = sn.replaceAll(wcp.collect { "\\" + it }.join('|'), '_');def BR = n.replaceAll(wcp.collect { "\\" + it }.join('|'), '_');def EM = bRl.contains(BR) ? "" : bRl;EM == 'Season '+ s || EM == 'Series '+ s ? "" : EM ? " - " + EM : ""}{"/"}{def eg = ["AkiraRIPS","Alqanime","BlackLuster","darkflux","It's Anime","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def CS = eg.find { Nt ->  fn.lower().contains(Nt.lower()) } ?: "";def KqV = any {CS} {(fn =~ /^\[(.*?)\]/)[0][1]} {group} {""};KqV ? "[$KqV] " : ""}{def swA = "TheMovieDB::TV";def aM = [[PA: 136342, GG: "Disney Twisted-Wonderland", lZZ: swA],[PA: 213830, GG: "I Was Reincarnated as the 7th Prince", lZZ: swA],[PA: 221165, GG: "Hyakusho Kizoku", lZZ: swA],[PA: 236565, GG: "Hero Without a Class", lZZ: swA],[PA: 262453, GG: "The Fated Magical Princess", lZZ: swA],[PA: 270660, GG: "Pochars", lZZ: swA],[PA: 277581, GG: "Dekin no Mogura", lZZ: swA],[PA: 278635, GG: "Unlimited Gacha", lZZ: swA],[PA: 280038, GG: "Apocalypse Bringer Mynoghra", lZZ: swA],[PA: 280405, GG: "Fudanshi Shoukan", lZZ: swA],[PA: 285260, GG: "Kaijyu Sekai Seifuku", lZZ: swA],[PA: 287704, GG: "Muzik Tiger In the Forest", lZZ: swA],[PA: 295625, GG: "Marie Antoinette ni Tensei Shita", lZZ: swA],[PA: 296047, GG: "Shuukan Ranobe Anime", lZZ: swA],[PA: 296319, GG: "Tomica Heroes Job Labor (TV)", lZZ: swA],[PA: 297286, GG: "Potions Will Save Me", lZZ: swA],[PA: 302169, GG: "Anila and Cocora", lZZ: swA]];def au = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def yx = au == "IMDb" ? "tt${id}" : id;def wC = n;aM.each {if (it.PA == yx && it.lZZ == au) {wC = it.GG}};def wcp = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def bRl = wC.replaceAll(wcp.collect { "\\" + it }.join('|'), '');bRl = bRl.replaceAll(/(\s|\.)*$/, '');bRl}{" - "}{s00e00}{def ZTm = (fn =~ /(?i)(?<![a-zA-Z])v(\d+)/);ZTm ? 'v' + ZTm[0][1] : ''}{def wcp = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def bRl = t.replaceAll(wcp.collect { "\\" + it }.join('|'), '_');bRl = bRl.length() > 100 ? " " : " - $bRl ";def yv = any { e } { special };def SYw = "Episode $yv";def dO = bRl.contains(SYw) ? '' : bRl;special ? dO : ''}{" ["}{def TDt = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA", "ABEMATV"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["BUMP"],["CMIC", "COOLMIC"],["CTHP"],["FOD"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LFTL", "LAFTEL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NBLA.WEB-DL", "Nebula"],["NF.WEB-DL", "NF WEB"],["OVEIL", "OV.WEB-DL", "OceanVeil"],["SHAHID"],["TVER"],["UNEXT"],["VIDIO"],["VIU"],["WETV"],["INSTA", "INSTAGRAM"],["ANIMENOTANE"],["TWTR"]];def gD = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU", "Kusonime"];def CoE = ["DB"];def JnH = ["Ruri-Saizen"];def EWo = ["Erai-raws", "SubsPlease"];def yBN = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def R_ = any {def Bd = TDt.find { KEf ->  KEf.find { sC ->  fn.lower().contains(sC.lower()) } }[0];Bd = Bd.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {Bd = Bd.replace(".WEBRip", "");Bd = Bd + ".WEBRip"} else {Bd = Bd + ".WEB-DL"};Bd} {source} {gD.find { yy ->  group == yy || yBN == yy } ? "WEBRip" : ""} {CoE.find { yy ->  group == yy || yBN == yy } ? "BDRip" : ""} {JnH.find { yy ->  group == yy || yBN == yy } ? "HDTVRip" : ""} {def jum = EWo.find { KVE ->  group == KVE || yBN == KVE} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : jum} {vs} {""};R_ ? "$R_ " : ""}{def EKa = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $EKa, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def Wq = any { audioLanguages.size() } { 0 };def Px = Wq > 2 ? " MULTi-AUD" : Wq > 1 ? " DUAL-AUD" : "";def qZ = Wq > 5 ? audioLanguages.take(5) : audioLanguages;def NV = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : " DUBBED";Px = Wq == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : "$Px$NV";Px}{def SXM = text.language.collect {['zh-Hans': 'ZH-S','zh-Hant': 'ZH-T','ar-001': 'AR-MSA'].get(it,it).toUpperCase()}.unique();def sK = any { SXM.size() } { 0 };def Px = sK > 2 ? ", MULTi" : sK > 1 ? ", DUAL" : sK == 1 ? ", SUB" : null;Px}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def no = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def cgO = subt;no.values().each { ARP -> if (cgO.contains(ARP)) {cgO = cgO.replace(ARP, "")}};no.iso3b + cgO}}{f.image ? "-thumb" : ""}
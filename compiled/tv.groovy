{def ugb = { System.getProperty(it) };def AD = ugb("os.name").toLowerCase().contains("windows");def KeA = ugb("user.name");def jlw = "/run/media/${KeA}";def bev = AD ? "H:/" : "$jlw/Videos";def vV = [[PJw: "Books", eo: "F:/", iuw: "$jlw/Books"],[PJw: "Data", eo: "D:/", iuw: "$jlw/Data"],[PJw: "Games", eo: "G:/", iuw: "$jlw/Games"],[PJw: "Music", eo: "E:/", iuw: "$jlw/Music"],[PJw: "Videos", eo: "H:/", iuw: "$jlw/Videos"]];def pH = (vV.collect { it[AD ? "eo" : "iuw"] as File }.sort { iIF, tyg ->  iIF.exists() <=> tyg.exists() ?: iIF.diskSpace <=> tyg.diskSpace }).last();def Bg = bev ?: pH;"$Bg/"}{"Videos/"}{def rHg = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def _nE = "TheMovieDB::TV";def AA = [[ 74180, _nE],[ 93821, _nE],[ 95897, _nE],[220118, _nE],[249891, _nE],[271026, _nE]];def ZS = [[236530, _nE]];def XF = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Mh = XF == "IMDb" ? "tt${id}" : id;def k_M = any { info.adult } { false };def EqC = AA.find { it[0] == Mh && it[1] == XF } != null;def DnP = ZS.find { it[0] == Mh && it[1] == XF } != null;def Gvi = info.Keywords.findAll { it in rHg } || EqC || k_M;Gvi = DnP ? false : Gvi;Gvi ? "R18+ " : ""}{def eO = ["CN", "JP", "KR", "KP", "TW", "HK"];def oFX = ["aeni", "donghua", "anime"];def ut = any {anime} || info.Keywords.findAll { it in oFX } || (eO.contains(country) && genres =~ /Animation/);ut ? "Anime/" : "TV Series/"}{def _nE = "TheMovieDB::TV";def FR = [[IY: 213830, Ia: "I Was Reincarnated as the 7th Prince", yP: _nE],[IY: 232230, Ia: "Lord of the Mysteries", yP: _nE],[IY: 238460, Ia: "Sumikko Gurashi Sorairo no Mainichi Tokubetsu-hen", yP: _nE[IY: 270660, Ia: "Pochars", yP: _nE],[IY: 277581, Ia: "Dekin no Mogura", yP: _nE],[IY: 280038, Ia: "Apocalypse Bringer Mynoghra", yP: _nE],[IY: 280405, Ia: "Fudanshi Shoukan", yP: _nE],[IY: 285260, Ia: "Kaijyu Sekai Seifuku", yP: "_nE"],[IY: 295625, Ia: "Marie Antoinette ni Tensei Shita", yP: _nE],[IY: 296047, Ia: "Shuukan Ranobe Anime", yP: _nE],[IY: 296319, Ia: "Tomica Heroes Job Labor (TV)", yP: _nE]];def XF = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Mh = XF == "IMDb" ? "tt${id}" : id;def SL = n;FR.each {if (it.IY == Mh && it.yP == XF) {SL = it.Ia}};def MH = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def lyJ = SL.replaceAll(MH.collect { "\\" + it }.join('|'), '');lyJ = lyJ.replaceAll(/(\s|\.)*$/, '');lyJ}{def _nE = "TheMovieDB::TV";def KYl = [[ 95897, _nE],[123542, _nE],[239779, _nE],[257162, _nE],[259140, _nE],[276204, _nE]];def GCt = KYl.find { it[0] == id && it[1] == info.database } != null;def bh = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def acU = bh[info.database];GCt ? " ($y) [${acU}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def MH = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def lyJ = sn.replaceAll(MH.collect { "\\" + it }.join('|'), '_');def b_o = n.replaceAll(MH.collect { "\\" + it }.join('|'), '_');def gYM = lyJ.contains(b_o) ? "" : lyJ;gYM == 'Season '+ s || gYM == 'Series '+ s ? "" : gYM ? " - " + gYM : ""}{"/"}{def LAD = ["Alqanime","BlackLuster","darkflux","It's Anime","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def jN = LAD.find { vh ->  fn.lower().contains(vh.lower()) } ?: "";def LbI = any {jN} {(fn =~ /^\[(.*?)\]/)[0][1]} {group} {""};LbI ? "[$LbI] " : ""}{def _nE = "TheMovieDB::TV";def FR = [[IY: 213830, Ia: "I Was Reincarnated as the 7th Prince", yP: _nE],[IY: 232230, Ia: "Lord of the Mysteries", yP: _nE],[IY: 238460, Ia: "Sumikko Gurashi Sorairo no Mainichi Tokubetsu-hen", yP: _nE[IY: 270660, Ia: "Pochars", yP: _nE],[IY: 277581, Ia: "Dekin no Mogura", yP: _nE],[IY: 280038, Ia: "Apocalypse Bringer Mynoghra", yP: _nE],[IY: 280405, Ia: "Fudanshi Shoukan", yP: _nE],[IY: 285260, Ia: "Kaijyu Sekai Seifuku", yP: "_nE"],[IY: 295625, Ia: "Marie Antoinette ni Tensei Shita", yP: _nE],[IY: 296047, Ia: "Shuukan Ranobe Anime", yP: _nE],[IY: 296319, Ia: "Tomica Heroes Job Labor (TV)", yP: _nE]];def XF = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Mh = XF == "IMDb" ? "tt${id}" : id;def SL = n;FR.each {if (it.IY == Mh && it.yP == XF) {SL = it.Ia}};def MH = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def lyJ = SL.replaceAll(MH.collect { "\\" + it }.join('|'), '');lyJ = lyJ.replaceAll(/(\s|\.)*$/, '');lyJ}{" - "}{s00e00}{def MH = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def lyJ = t.replaceAll(MH.collect { "\\" + it }.join('|'), '_');lyJ = lyJ.length() > 100 ? " " : " - $lyJ ";def CD = any { e } { special };def ZpO = "Episode $CD";def yeB = lyJ.contains(ZpO) ? '' : lyJ;special ? yeB : ''}{" ["}{def mjV = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA", "ABEMATV"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["CMIC", "COOLMIC"],["CTHP"],["FOD"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LFTL", "LAFTEL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["OVEIL", "OV.WEB-DL", "OceanVeil"],["SHAHID"],["TVER"],["UNEXT"],["VIDIO"],["VIU"],["WETV"],["INSTA", "INSTAGRAM"],["ANIMENOTANE"],["TWTR"]];def TR_ = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def bRA = ["DB"];def Qjn = ["Ruri-Saizen"];def Of = ["Erai-raws", "SubsPlease"];def WYj = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def AP = any {def zB = mjV.find { WGc ->  WGc.find { nA ->  fn.lower().contains(nA.lower()) } }[0];zB = zB.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {zB = zB.replace(".WEBRip", "");zB = zB + ".WEBRip"} else {zB = zB + ".WEB-DL"};zB} {source} {TR_.find { UWE ->  group == UWE || WYj == UWE } ? "WEBRip" : ""} {bRA.find { UWE ->  group == UWE || WYj == UWE } ? "BDRip" : ""} {Qjn.find { UWE ->  group == g__ || WYj == g__} ? "HDTVRip" : ""} {def fw = Of.find { Pm ->  group == Pm || WYj == Pm} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : fw} {vs} {""};AP ? "$AP " : ""}{def WcI = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $WcI, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def YRW = any { audioLanguages.size() } { 0 };def XVw = YRW > 2 ? " MULTi-AUD" : YRW > 1 ? " DUAL-AUD" : "";def pxi = YRW > 5 ? audioLanguages.take(5) : audioLanguages;def NVx = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : " DUBBED";XVw = YRW == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : "$XVw$NVx";XVw ? XVw + pxi.ISO2.joining(" ", " (", "").upper() + (YRW > 5 ? " ...)" : ")") : ""}{def oC = text.language.collect {['zh-Hans': 'ZH-S','zh-Hant': 'ZH-T','ar-001': 'AR-MSA'].get(it,it).toUpperCase()}.unique();def XVY = any { oC.size() } { 0 };def XVw = XVY > 2 ? ", MULTi" : XVY > 1 ? ", DUAL" : XVY == 1 ? ", SUB" : null;def pxi = XVY > 5 ? oC.take(5) : oC;XVw ? XVw + pxi.joining(" ", " (", "").upper() + (XVY > 6 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def HHa = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def uDH = subt;HHa.values().each { ps -> if (uDH.contains(ps)) {uDH = uDH.replace(ps, "")}};HHa.iso3b + uDH}}{f.image ? "-thumb" : ""}
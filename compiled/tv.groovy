{def vG = { System.getProperty(it) };def _aL = vG("os.name").toLowerCase().contains("windows");def Xi = vG("user.name");def QCt = "/run/media/${Xi}";def RpB = _aL ? "H:/" : "$QCt/Videos";def bA = [[qOV: "Books", tik: "F:/", Sow: "$QCt/Books"],[qOV: "Data", tik: "D:/", Sow: "$QCt/Data"],[qOV: "Games", tik: "G:/", Sow: "$QCt/Games"],[qOV: "Music", tik: "E:/", Sow: "$QCt/Music"],[qOV: "Videos", tik: "H:/", Sow: "$QCt/Videos"]];def jRy = (bA.collect { it[_aL ? "tik" : "Sow"] as File }.sort { cTI, Oj ->  cTI.exists() <=> Oj.exists() ?: cTI.diskSpace <=> Oj.diskSpace }).last();def vY = RpB ?: jRy;"$vY/"}{"Videos/"}{def fN = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def sO = "TheMovieDB::TV";def qw = [[ 74180, sO],[ 93821, sO],[ 95897, sO],[220118, sO],[249891, sO],[271026, sO]];def Hx = [[236530, sO]];def SWO = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def JQ = SWO == "IMDb" ? "tt${id}" : id;def NV = any { info.adult } { false };def AO_ = qw.find { it[0] == JQ && it[1] == SWO } != null;def Wc = Hx.find { it[0] == JQ && it[1] == SWO } != null;def l_r = info.Keywords.findAll { it in fN } || AO_ || NV;l_r = Wc ? false : l_r;l_r ? "R18+ " : ""}{def gEz = ["CN", "JP", "KR", "KP", "TW", "HK"];def jc = ["aeni", "donghua", "anime"];def Ji = any {anime} || info.Keywords.findAll { it in jc } || (gEz.contains(country) && genres =~ /Animation/);Ji ? "Anime/" : "TV Series/"}{def sO = "TheMovieDB::TV";def XAO = [[pa: 213830, CoC: "I Was Reincarnated as the 7th Prince", hiA: sO],[pa: 236565, CoC: "Hero Without a Class", hiA: sO],[pa: 238460, CoC: "Sumikko Gurashi Sorairo no Mainichi Tokubetsu-hen", hiA: sO],[pa: 270660, CoC: "Pochars", hiA: sO],[pa: 277581, CoC: "Dekin no Mogura", hiA: sO],[pa: 280038, CoC: "Apocalypse Bringer Mynoghra", hiA: sO],[pa: 280405, CoC: "Fudanshi Shoukan", hiA: sO],[pa: 285260, CoC: "Kaijyu Sekai Seifuku", hiA: sO],[pa: 295625, CoC: "Marie Antoinette ni Tensei Shita", hiA: sO],[pa: 296047, CoC: "Shuukan Ranobe Anime", hiA: sO],[pa: 296319, CoC: "Tomica Heroes Job Labor (TV)", hiA: sO]];def SWO = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def JQ = SWO == "IMDb" ? "tt${id}" : id;def Une = n;XAO.each {if (it.pa == JQ && it.hiA == SWO) {Une = it.CoC}};def cZM = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rD = Une.replaceAll(cZM.collect { "\\" + it }.join('|'), '');rD = rD.replaceAll(/(\s|\.)*$/, '');rD}{def sO = "TheMovieDB::TV";def Dx = [[ 95897, sO],[123542, sO],[239779, sO],[257162, sO],[259140, sO],[276204, sO]];def LF = Dx.find { it[0] == id && it[1] == info.database } != null;def kip = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def we = kip[info.database];LF ? " ($y) [${we}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def cZM = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rD = sn.replaceAll(cZM.collect { "\\" + it }.join('|'), '_');def lH = n.replaceAll(cZM.collect { "\\" + it }.join('|'), '_');def kq = rD.contains(lH) ? "" : rD;kq == 'Season '+ s || kq == 'Series '+ s ? "" : kq ? " - " + kq : ""}{"/"}{def Ul = ["AkiraRIPS","Alqanime","BlackLuster","darkflux","It's Anime","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def CL = Ul.find { lmr ->  fn.lower().contains(lmr.lower()) } ?: "";def an = any {CL} {(fn =~ /^\[(.*?)\]/)[0][1]} {group} {""};an ? "[$an] " : ""}{def sO = "TheMovieDB::TV";def XAO = [[pa: 213830, CoC: "I Was Reincarnated as the 7th Prince", hiA: sO],[pa: 236565, CoC: "Hero Without a Class", hiA: sO],[pa: 238460, CoC: "Sumikko Gurashi Sorairo no Mainichi Tokubetsu-hen", hiA: sO],[pa: 270660, CoC: "Pochars", hiA: sO],[pa: 277581, CoC: "Dekin no Mogura", hiA: sO],[pa: 280038, CoC: "Apocalypse Bringer Mynoghra", hiA: sO],[pa: 280405, CoC: "Fudanshi Shoukan", hiA: sO],[pa: 285260, CoC: "Kaijyu Sekai Seifuku", hiA: sO],[pa: 295625, CoC: "Marie Antoinette ni Tensei Shita", hiA: sO],[pa: 296047, CoC: "Shuukan Ranobe Anime", hiA: sO],[pa: 296319, CoC: "Tomica Heroes Job Labor (TV)", hiA: sO]];def SWO = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def JQ = SWO == "IMDb" ? "tt${id}" : id;def Une = n;XAO.each {if (it.pa == JQ && it.hiA == SWO) {Une = it.CoC}};def cZM = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rD = Une.replaceAll(cZM.collect { "\\" + it }.join('|'), '');rD = rD.replaceAll(/(\s|\.)*$/, '');rD}{" - "}{s00e00}{def tzV = (fn =~ /(?i)(?<![a-zA-Z])v(\d+)/);tzV ? 'v' + tzV[0][1] : ''}{def cZM = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rD = t.replaceAll(cZM.collect { "\\" + it }.join('|'), '_');rD = rD.length() > 100 ? " " : " - $rD ";def aI = any { e } { special };def Xem = "Episode $aI";def DW = rD.contains(Xem) ? '' : rD;special ? DW : ''}{" ["}{def fpy = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA", "ABEMATV"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["BUMP"],["CMIC", "COOLMIC"],["CTHP"],["FOD"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LFTL", "LAFTEL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NBLA.WEB-DL", "Nebula Proper ~ WEBDL"],["NF.WEB-DL", "NF WEB"],["OVEIL", "OV.WEB-DL", "OceanVeil"],["SHAHID"],["TVER"],["UNEXT"],["VIDIO"],["VIU"],["WETV"],["INSTA", "INSTAGRAM"],["ANIMENOTANE"],["TWTR"]];def SA = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def ky = ["DB"];def wL = ["Ruri-Saizen"];def jtF = ["Erai-raws", "SubsPlease"];def HtN = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def rMp = any {def Dmx = fpy.find { mZA ->  mZA.find { SS ->  fn.lower().contains(SS.lower()) } }[0];Dmx = Dmx.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {Dmx = Dmx.replace(".WEBRip", "");Dmx = Dmx + ".WEBRip"} else {Dmx = Dmx + ".WEB-DL"};Dmx} {source} {SA.find { ccL ->  group == ccL || HtN == ccL } ? "WEBRip" : ""} {ky.find { ccL ->  group == ccL || HtN == ccL } ? "BDRip" : ""} {wL.find { ccL ->  group == g__ || HtN == g__} ? "HDTVRip" : ""} {def oWt = jtF.find { ya ->  group == ya || HtN == ya} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : oWt} {vs} {""};rMp ? "$rMp " : ""}{def Uw = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $Uw, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def Rzx = any { audioLanguages.size() } { 0 };def aF = Rzx > 2 ? " MULTi-AUD" : Rzx > 1 ? " DUAL-AUD" : "";def arj = Rzx > 5 ? audioLanguages.take(5) : audioLanguages;def Ev = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : " DUBBED";aF = Rzx == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : "$aF$Ev";aF}{def Uq = text.language.collect {['zh-Hans': 'ZH-S','zh-Hant': 'ZH-T','ar-001': 'AR-MSA'].get(it,it).toUpperCase()}.unique();def LI = any { Uq.size() } { 0 };def aF = LI > 2 ? ", MULTi" : LI > 1 ? ", DUAL" : LI == 1 ? ", SUB" : null;aF}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def Qc = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def urM = subt;Qc.values().each { gh -> if (urM.contains(gh)) {urM = urM.replace(gh, "")}};Qc.iso3b + urM}}{f.image ? "-thumb" : ""}